<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>–¢–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ü–µ–Ω</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
    .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
    .success { background-color: #d4edda; border-color: #c3e6cb; }
    .error { background-color: #f8d7da; border-color: #f5c6cb; }
    table { width: 100%; border-collapse: collapse; margin: 10px 0; }
    th, td { padding: 8px; text-align: left; border: 1px solid #ddd; }
    th { background-color: #f2f2f2; }
    input { width: 300px; padding: 5px; margin: 5px 0; }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>üß™ –¢–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ü–µ–Ω</h1>
  
  <div class="test-section">
    <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ parseAndConvertPrice</h2>
    <p>–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ content.js –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ü–µ–Ω</p>
    
    <table>
      <thead>
        <tr>
          <th>–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç</th>
          <th>–†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏</th>
          <th>–°—Ç–∞—Ç—É—Å</th>
        </tr>
      </thead>
      <tbody id="test-results"></tbody>
    </table>
  </div>

  <div class="test-section">
    <h2>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç</h2>
    <p>–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å —Ü–µ–Ω–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä: "15 990 Ft" –∏–ª–∏ "129,99 ‚Ç¨"):</p>
    <input type="text" id="price-input" placeholder="15 990 Ft" value="15 990 Ft">
    <br>
    <button onclick="testCustomPrice()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–Ω—É</button>
    <div id="custom-result" style="margin-top: 10px;"></div>
  </div>

  <script>
    // –¢–µ—Å—Ç–æ–≤—ã–µ –∫—É—Ä—Å—ã
    let rate_hufeur = 0.00238392857142857142857142857143;
    let rate_eurrsd = 117;

    function parseAndConvertPrice(text) {
      const match = text.match(/([\d\s]+)\s*Ft/);
      if (!match) {
        const match = text.match(/([\d,\s]+)\s*‚Ç¨/);
        if (!match) {
          console.log("[IponPrices] ‚ùå Could not parse:", text);
          return null;
        }
        const eur = parseInt(match[1].replace(/\s/g, '').replace(',', ''));
        const converted_rsd = (eur * rate_eurrsd).toFixed(2);
        return `~RSD${converted_rsd}`;
      }
      const huf = parseInt(match[1].replace(/\s/g, ''));
      const converted = (huf * rate_hufeur).toFixed(2);
      const converted_rsd = (converted * rate_eurrsd).toFixed(2);
      return `~‚Ç¨${converted} / ~RSD${converted_rsd}`;
    }

    const testCases = [
      "15 990 Ft",
      "129,99 ‚Ç¨",
      "45 000 Ft",
      "299,50 ‚Ç¨",
      "1 000 Ft",
      "50 ‚Ç¨",
      "123456 Ft",
      "999,99 ‚Ç¨"
    ];

    function runTests() {
      const tbody = document.getElementById('test-results');
      tbody.innerHTML = '';

      testCases.forEach(testText => {
        const result = parseAndConvertPrice(testText);
        const isSuccess = result !== null;
        
        const row = document.createElement('tr');
        row.className = isSuccess ? 'success' : 'error';
        row.innerHTML = `
          <td><code>${testText}</code></td>
          <td>${result || '–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å'}</td>
          <td>${isSuccess ? '‚úÖ' : '‚ùå'}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function testCustomPrice() {
      const input = document.getElementById('price-input').value.trim();
      const resultDiv = document.getElementById('custom-result');
      
      if (!input) {
        resultDiv.innerHTML = '<p style="color: red;">–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É!</p>';
        return;
      }

      const result = parseAndConvertPrice(input);
      
      if (!result) {
        resultDiv.innerHTML = `
          <div class="error">
            <p>‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å —Ü–µ–Ω—É: <code>${input}</code></p>
            <p>–§–æ—Ä–º–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: "—á–∏—Å–ª–æ Ft" –∏–ª–∏ "—á–∏—Å–ª–æ ‚Ç¨"</p>
            <p>–ü—Ä–∏–º–µ—Ä—ã: "15 990 Ft", "129,99 ‚Ç¨"</p>
          </div>
        `;
      } else {
        resultDiv.innerHTML = `
          <div class="success">
            <p>‚úÖ –¶–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–∞!</p>
            <p>–ò—Å—Ö–æ–¥–Ω–∞—è —Ü–µ–Ω–∞: <code>${input}</code></p>
            <p>–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞: <strong>${result}</strong></p>
            <p>–≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ —Ü–µ–Ω—É –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏.</p>
          </div>
        `;
      }
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('load', runTests);
  </script>
</body>
</html>

